<!DOCTYPE html>
<html>
<!-- Jquery -->
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<!--   Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
 <!--  FIREBASE -->
  <script src="https://www.gstatic.com/firebasejs/3.9.0/firebase.js"></script>
<head>
	<title>Login Page</title>
</head>
<body>
	<div id="pageTitle"><h1>Boogaloo Travel Journal</h1></div>
<div class="container" id="new user" class="col-md-5">
	<div class="col-md-5"> Gmail Account</div> 
	<input type="text" id="newUserGmailInput" class="form-control" placeholder="Gmail Account">	
	<div class="col-md-5"> Create passwork</div> 
	<input type="text" id="newUserPasswordInput" class="form-control" placeholder="Password">
	<button id="newUserSubmit" class="btn btn-danger" type="button">Submit New User</button> 
</div>
<div class="container" id="userLogOn" class="col-md-5">
	<div class="col-md-5"> Gmail Account</div> 
	<input type="text" id="userGmailInput" class="form-control" placeholder="Gmail Account">	
	<div class="col-md-5">Password</div> 
	<input type="text" id="userPasswordInput" class="form-control" placeholder="Password">
	<button id="userSubmit" class="btn btn-danger" type="button">Submit</button> 
</div>

<script type="text/javascript">
$(document).ready(function() {
var userNumber = 1;	
//FIREBASE CONFIG
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyDQeAXWZpnytGGVtlyNngDlMoAf-PRiCKk",
    authDomain: "userlogs-a1164.firebaseapp.com",
    databaseURL: "https://userlogs-a1164.firebaseio.com",
    projectId: "userlogs-a1164",
    storageBucket: "userlogs-a1164.appspot.com",
    messagingSenderId: "621543108481",
}
firebase.initializeApp(config);
var database = firebase.database();
//CREATE NEW USER FUNCTIONALITY
//on click function for submit new user button
$("#newUserSubmit").on("click", function(){
	$("#newUserGmailInput").empty();
//logs the user's inputed email in the gmail variable
var email = $("#newUserGmailInput").val().trim();
//checks to make sure the user has entered an email that ends with @gmail.com	
var log = email.endsWith("@gmail.com");
var password = $("#newUserPasswordInput").val().trim();
//if true, adds the gmail to the database and the created password
if (log == true) {
	console.log("new user created!");
	firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {
  // Handle Errors here.
  	var errorCode = error.code;
  	var errorMessage = error.message;
  	console.log(errorCode + errorMessage);
  	});
}
	
//if false, reports an error to the user - change this to  a modal not an alert	
		else(alert("email must be gmail account"))
			//empty the input -------THIS IS NOT WORKING :(
			$("#newUserGmailInput").empty();
		
});

$("#userSubmit").on("click", function(){
	var userPassword = $("#userPasswordInput").val().trim();
	var userEmail = $("#userGmailInput").val().trim();
	firebase.auth().signInWithEmailAndPassword(userEmail, userPassword).catch(function(error) {
  		var errorCode = error.code;
  		var errorMessage = error.message;
  		console.log(errorMessage + errorCode);
  		console.log("LOGIN WORKED");
	});
});


firebase.auth().signOut().then(function() {
  // Sign-out successful.
}).catch(function(error) {
  // An error happened.
});



















// var dbNumber = $("#userNumberInput").val().trim();
// var ref = database.ref();
// //pull the database object with a user number equal to the inputed user number
// ref.equalTo(dbNumber).on("child_added", function(snapshot) {
// console.log(snapshot.key);
// console.log("IT WORKS!");
// });

// database.ref().on("child_added", function(childSnapshot) {
// var dbUser = childSnapshot.val();
// var dbNumber = $("#userNumberInput").val().trim();
// var dbEmail = $("#userGmailInput").val().trim();
// 		console.log(dbUser.userGmail);
// 		if(dbUser.userNumber == dbNumber && dbUser.userGmail == ){
// 			console.log("LOGIN SUCCESSFUL");
// 			//THIS IS WHERE THE HTML WILL BE CHANGED TO THE MAIN USER PAGE 
// 		}
// 		else(){
// 			console.log("LOGIN ERROR");
// 		}
// });
//FOR OLD USER RETURN CHECK TO SEE IF THE USER NUMBER TIED TO THE USER GMAIL ACCOUNT MATCHES, IF SO LOGIN IF NOT REPORT ERROR

//SAVE THE GMAIL ACCOUNT FOR EACH USER, THIS WILL ALLOW US TO USE IT FOR OTHER GOOGLE APIS

});
</script>
</body>
</html>